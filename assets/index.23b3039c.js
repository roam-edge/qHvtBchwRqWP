import{m as b,bv as g,bw as k,bx as E,aY as F,k as x,M as c,by as y,s as V,v as C,w as a,D as t,W as R,bz as U,b4 as I}from"./index.05095889.js";import{E as B,b as N,a as T}from"./el-col.e4630a57.js";import{E as W,a as M}from"./el-form.f2166b5b.js";import"./error2.da4b2d97.js";const S=R("login"),G=b({__name:"index",setup(q){const p=g(),m=k(),{setToken:d}=E(),{setUserName:f}=F(),u=x(),o=c({pass:"",checkPass:""}),_=c({pass:[{validator:(l,e,s)=>{if(e==="")s(new Error("Please input the password"));else{if(o.checkPass!==""){if(!u.value)return;u.value.validateField("checkPass",()=>null)}s()}},trigger:"blur"}],checkPass:[{validator:(l,e,s)=>{e===""?s(new Error("Please input the password again")):e!==o.pass?s(new Error("Two inputs don't match!")):s()},trigger:"blur"}]}),w=l=>{!l||l.validate(async e=>{if(e){console.log("submit!"),d(o.pass);const[s,n]=await U();if(s)return!1;f(n.login),I.success("\u767B\u5F55\u6210\u529F");const r=decodeURIComponent(m.query.redirect);r.startsWith("http")?window.location.href=r:r.startsWith("/")?p.push(r):p.push("/")}else return console.log("error submit!"),!1})};return(l,e)=>{const s=B,n=W,r=y,h=M,v=N,P=T;return V(),C(P,{gutter:20,style:{"margin-top":"150px"}},{default:a(()=>[t(v,{span:12,offset:6},{default:a(()=>[t(h,{ref_key:"ruleFormRef",ref:u,model:o,"status-icon":"",rules:_,"label-width":"120px",class:"demo-ruleForm"},{default:a(()=>[t(n,{label:"Password",prop:"pass"},{default:a(()=>[t(s,{modelValue:o.pass,"onUpdate:modelValue":e[0]||(e[0]=i=>o.pass=i),"prefix-icon":"el-icon-lock",type:"password","show-password":"",autocomplete:"on"},null,8,["modelValue"])]),_:1}),t(n,{label:"Confirm",prop:"checkPass"},{default:a(()=>[t(s,{modelValue:o.checkPass,"onUpdate:modelValue":e[1]||(e[1]=i=>o.checkPass=i),"prefix-icon":"el-icon-lock","show-password":"",clearable:"",type:"password",autocomplete:"on"},null,8,["modelValue"])]),_:1}),t(n,null,{default:a(()=>[t(r,{type:"primary",onClick:e[2]||(e[2]=i=>w(u.value))},{default:a(()=>[S]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})}}});export{G as default};
